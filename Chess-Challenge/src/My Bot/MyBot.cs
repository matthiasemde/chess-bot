#define DEBUG_LEVEL_0
// #define DEBUG_LEVEL_1
// #define DEBUG_LEVEL_2
// #define DEBUG_LEVEL_3

using System;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Collections.Generic;
using ChessChallenge.API;


public class MyBot : IChessBot
{
    // Encoded weights
    readonly decimal[] weights = {
        308276118214120892079734785m,59656483889577223501562630374m,61257347627577764468823735287m,72704684882831343711178783486m,  
        622611056434986672127408632m,1208923581853297559264241m,65876681424985531139695364832m,76092028490181680962293923064m,      
        77990189638691099116132298738m,8972618896714385046286439965m,9319665995975479425234314011m,71804016182669890193345599739m,  
        76367834060421953417304603343m,72993551909367938662616655577m,69907178662262596676718489823m,73608905115606666566937541123m,
        77685464073453727702435092730m,65880204549756200831024297189m,1538919827410876172600345842m,73663434022551508783687068669m, 
        2475780446987134631336411637m,3428508787256755659875409855m,67421636308706159594553994716m,64967526542542370591675314128m,  
        285211379201268100384090851m,74234009358737142126507254761m,71503036393823000417413554404m,78922157224522497801078958331m,  
        66794227917211312200755501521m,2132388682749325303915544858m,12415829192540727168870717195m,8745573918545683934617007120m,  
        78917473338761023203364044544m,7499047012928230184118073890m,15543466941456870156193836071m,8104814327454577796810744596m,
        13072176776319917723843241814m,78921104836624413091473582832m,75837106480716320210281034752m,75214614202731353557255062275m,
        9666604153990296608884921673m,668754279539712290074462466m,76446476685691851563286724372m,2835039830121019849890799637m,
        9323406684766233480566741799m,6234572992277699577919054363m,13975305849956458923271725613m,1870231632841907292443963119m,
        78588716479428523887703885569m,1559514252904176518563103489m,74566629520256368693988821264m,940620400158232394065449227m,
        75819081960849996940933204234m,17974384791613237234142414616m,8374295137201715125161106193m,9626728563240223550966993154m,
        4974630744541455538512533786m,7132813453192159020239613427m,2772010166023111693731304695m,18992521990689849557442386487m,
        5880138854765565545069085166m,75832346443825667903066075124m,4949398510636437496002507250m,65882697700710013663871228124m,
        78611601067042791612160605699m,77363975159024915500630670076m,77674673890963732142791260922m,77984158863819532560963795451m,
        77362766270532831142445972475m,78919891187785566286527130366m,70839293507090207432172233955m,70528604275441325586287551462m,
        70216691987694526299409408736m,70217896191291776545566483427m,70531059905940356917866390754m,69290654809869442170847683814m,
        69600130337991715012173029858m,70216691932209335556162905058m,70527390682595462511897731809m,70527381182593475517268682212m,
        64936028485345187027058021073m,65554993413759134451239015126m,64934809782751493698679198159m,64315839670802744119372468690m,
        65247940422675620621584487121m,64936023390933475613731039185m,51883047424692358099778315942m,52197368174829768293411694247m,
        52194950341637002741879842982m,51574776118324725475430672805m,50957000809367763208223630499m,3728388951293491866715818765m,
        3109390468323848254816717322m,3105768339373294470128536075m,3417675941790655662392937483m,3108205117515503306361539848m,
        79226963273275004906199121667m,933286066005603770020725764m,1244008354292203655677608708m,1552279716071848983834854405m,
        932096084774568285494772996m,621392614048612485070197758m,8699567351515148460616391710m,9007843786148851121882209308m,
        9320946054764700277126602269m,8698358775966652921055747102m,9007834304450059261307591195m,9009057434191113799501421083m,
        9009062119736166120060296734m,9011470581982664059288100382m,8700776590928566827035270172m,9319741869614196307997236255m,
        13363674350875326210999331627m,13982654091880085607985131054m,14289716546142181143136382511m,14293348064559213794617535535m,
        13981435739629286405949893933m,13358829445781919779440712491m,28273584230868133123945092953m,27650973303632696240150109016m,
        28273579563769260836271053659m,28272365897280814827232057692m,27652186964404857154060311127m,2176118551115633780907772171m,
        3418908461140335055900118283m,3109414080373850482408098317m,4664106814531316546087620108m,3417685460094704224704400651m,
        311964472718559420855811842m,77343456422035251042902474497m,4025765463684905191967629587m,3132837774090205941227721222m,
        66227322488637348597971223258m,620188407335669274935361536m,74579885145037767285328177889m,75196314144850801563008041463m,
        951438805367042019883939845m,2507374223964641435425972227m,78620134457139185716733870095m,74879627637395485232887495411m,
        69936377019360197812029746163m,897065238740268342806836221m,3088724985106572111078555389m,79205150161972958968044648944m,
        79223293459057251167596831988m,75809168848336201173721022725m,74560485609261406990036822772m,1858161450674494477386513920m,
        7767391171049867450281296661m,8047909274926547017938506241m,2166423310643639689927984391m,77982964216786387690486040834m,
        3104521340915627694674610192m,4354584247643147044950577420m,1848613357781345227959304715m,74554402997883265895816100858m,
        76770425528642664632100055796m,77993981848940863938073461268m,12111132787338281133662670622m,76743781694166521481337961713m,
        620031956825108314788528639m,69601310339824362038376195020m,75187936151354543179388150775m,286652367443997007881439494m,
        76740235642046125451359222240m,618979463799747109070701312m,3391036628869444014193762035m,70231345899321220520438328568m,
        2784222350216162380433583620m,3102013799261155879134959883m,5584104010969753172171952909m,77968390808421686576244786667m,
        7437339791790406451504283899m,78276690837949775145781100819m,76782651978368477771337031968m,10215470216173866086076314628m,
        75493786358875007504069627371m,76735314935087557114989767674m,78906555153004428934914111732m,3106854336592285002320318717m,
        2180968550692251737455927577m,77381013806767987243502079765m,76758350675971595624429714678m,72722871085164095327240053725m,
        3429736773986241907128590354m,1536535310046480995667737860m,2201444510116442572965806856m,921059598399923974571424256m,
        70877998172815620051612197601m,74872241617202347160039590658m,9324506479426684083890684168m,3738050654575655592472871690m,
        79196735111781767359017976320m,906784661522383877250092816m,10563731408513131964045989915m,4967528841327496506389629718m,
        15810469278659338706935497803m,311898121513444821973467648m,921215789579468294133711621m,2494014075755362999354524399m,
        8333215272669744399449003806m,9337984390794782951651939345m,8688621402768953895029900569m,10238473159175640999518539537m,
        31484349962542395436566780m,77059416057712195957239835391m,77067769465081615341205522698m,76445319242424581412715161087m,
        77691603112271914285245075972m,77680732299782728985056515312m,76140594176613065991462719496m,934646384327886800213705202m,
        76143026213376010622847289100m,78906536340364616387098515466m,75572622192687521202346400794m,11484923530059222919952024883m,
        14599187073611218502451534376m,13363688350145879473876182301m,2531661392492480935243357989m,9611102659101045677542741014m,
        78651680087899342820145893405m,72733908088415475824314079204m,7097570764164013790876996907m,5303718904715048942035728405m,
        1194375319361973497389842687m,70479977716626308252068136887m,77002382505452060819174580708m,75468351011551907276172487395m,
        78270632003558885260860064503m,311902915641108556184420610m,77999860678180153526775043302m,63063440301348609167233045206m,
        77056870057259604754802208515m,76166010229803910608022602761m,5579240046487601076889195519m,79209820526283732381088018398m,
        76119900137335773820853801450m,73930625700248015775476019937m,78580182719890267775159764993m,74598023682494514025630395135m,
        64348736120822463840875038180m,68350068333493096447868657627m,77293705478318373724499148791m,5568340752660437120495579386m,
        4618035332471915163280476927m,4966300452232928473145795078m,69322234014287620131363425796m,74574917310108857470207003374m,
        3735609042804395890817828371m,2818129199310086328764797705m,76168498823620116351561755882m,13339301292806534226939150358m,
        3434558034982916472009130498m,13028844639808500887064295436m,8436192393450999160215181612m,342201840665490076633000701m,
        8333021561107750023139033346m,2769672644540060737375960566m,78604356699107770907614253335m,77069182445907256460183270397m,
        74868752193113113344872557389m,618970000325067944734163967m,75196300438196544229355681269m,76126007044154772337544065276m,
        72102706452862271395826235908m,78604332995332392183737350133m,70858561131277736986883852804m,74572593702523119472713531391m,
        76439208335255929581236518127m,1236740466255489898074601725m,77669866652019075131180582916m,78299773690239101154851355649m,
        74232819451301288712710654472m,77980565327610252952368771320m,77982869639677329975162440191m,77366445030772645449825059072m,
        77359158363732314960771483383m,6517333184832830685175280389m,77992621546962688105596652546m,1853268893444290854588187904m,
        7114476502040484347932052743m,1258529576105232266160636933m,75508293210824443262418421000m,8379121765112450331275887872m,
        3409180348063201384469566475m,5902103780326502853565217541m,1217374039722272168021529337m,65251831635368771236473593818m,
        72377004484419682672209690625m,77649143965953642012510052086m,74539924462563096962870932405m,922361535804164711576305921m,
        935713343859275267646414287m,309489733056472923557134335m,919992566959284331118266365m,1544926695948975662281783819m,
        74891773933648834040621563375m,929649419173609580574474506m,1858156800208254489273234930m,74281299377450629139609020923m,
        75494952193602352366545598723m,77984149566589025841107894266m,2484300095476573057610082036m,307047751702099355930460671m,
        77370076272409971110427031521m,77359087085078602356276983795m,612896853067570169806711259m,75492472710313121454643540721m,
        71135579870223882194039402225m,78605508679611692047114236921m,1532903679509765962733909744m,76728027899616765936369858285m,
        1845972872673269595097001203m,75823770423585757309048254202m,73959616419910454202735001340m,69590477912776121181693665781m,
        6512350556558386463057699292m,74279938949169876021025700104m,3724785712241221734772763361m,5258670833109402184285165076m,
        10867147972177180909830537443m,74877233765229052957987895290m,6206601123528696287362613523m,78615213955694508533501391057m,
        76121077021894811788020357145m,2427940916108066472067073m,77356688418485844504111278840m,70223945690691423189754837752m,
        78613999458810152914552743649m,77664974188258825671454423804m,922457698031412116771901937m,72066377250902891224376209923m,
        2792622977575761378260483038m,2769701036023045228740016624m,74264317490683044634388596234m,2785374736691732619111494412m,
        77365354124264422928929716980m,77666186801043441157289211132m,69011483076625292987548759779m,77995043642803215531737940460m,
        2792585755435498387422785801m,4050062111578894918843895560m,78276723578040442000743203550m,938149901362248113151410682m,
        77385754879988870739412194795m,10556500561827041962990830887m,8405845917644581793240722146m,9600104007144327095780058648m,
        8396098784379443283299269924m,917457431714154028977361920m,11795441595442231310083229207m,9601180612579070272299857654m,
        70539470682767499960954913256m,45115406827316193271583214033m,70243387102666498631573236445m,73946327718097882880640021727m,
        5241869002487561796139808529m,622606720513653306841760511m,77035137874215513004756567029m,78317926374546557343305040644m,
        78297280243051141361828955889m,77674754613843174964931393288m,319198992327992752133575430m,73023927038383823047732880374m,
        2471025281978248515284108546m,77367568676857849569570783475m,1860517707687779373589397506m,77360362826094283306413386230m,
        75198798755611461110164223510m,2472210283304454188369507822m,77992640178973301193540367878m,72082150176892219986225591807m,
        917574256310066052903332616m,71777449182654380017029868771m,79213598774146274733315986423m,2189369677774935652851710468m,
        2189411921686079972936584204m,3406847646452495772685567491m,5275733534766665530572018220m,64644668618270994241938054359m,
        64616895220280964452446564816m,77382325689218276641456258824m,11811371300536932761376078128m,16161237977207233866420400686m,
        14939009394368737284624225337m,6049369913541924414816505m,74579814384623417929765288436m,78922299521199585415355235326m,
        74240063358206427320874299369m,78611482030638450879783633407m,73016626056590996930534896869m,74897690615264171668109582827m,
        68979951539669045885590694372m,77056794036644253975478528746m,63381439738090819741829754103m,73340636125509559507451964393m,
        71153642646479638212174278111m,71784725371068915784270077163m,69596503616018347788281505510m,69598940099879009398867025637m,
        70530941551342156265714413280m,72088132768653211157923948525m,68976357781377963415511948498m,70221503839263920721279310045m,
        67726271741927560706877807065m,71441206135647683338954525907m,66493119996775316815502825189m,65259977513335122051343172804m,
        58723230657469760858066569407m,64007487771043697339393953480m,58712421122975838605468608956m,70195998045260735347191780347m,
        6210355810061900199147409167m,1552369754335280785486254860m,1872592908742121369129720852m,57816976601133628966923524040m,
        76104226512477345716461559782m,78905379319921981732027575558m,8709238905281777308765458439m,621435389950261041024927493m,
        78605575198716364228160257792m,928450271506165249513488130m,6544019541929063609765010450m,10556539151330574892334916884m,
        12113621384847534224509579049m,3397233386971412882433054223m,2488021376116184861768290062m,76136953490891873523251483398m,
        11781020391957797403137873684m,10853906624457957359263032600m,7773530597384211463518101790m,6853528401591288060741294614m,
        3734461862146075502742739719m,15839573890397433234166788663m,18944104600382708272126964533m,8064943387448554966266747162m,
        11481282235515776599724469798m,6210451057035808079286901013m,38521780908731217715068957823m,23602456013548105060310017886m,
        33232640407981284251213720431m,24841519589253749168372272983m,24236924176049975915220592990m,55033151999685515116435862241m,
        76422174114581426910559336700m,4041529054255758831123956746m,1546225567660066638399146250m,76786136990003909267157615101m,
        79208810422510009470443129860m,1549842864072279559947795178m,67735995002286859579027288544m,3413916716418285437950551788m,
        76429375943093976262292073195m,78913775392597639368504574467m,292598158956586025104513275m,73652596394761891424782050552m,
        75197598905665382588576169730m,5865731688312113950103564030m,77360315233199039618553743872m,72153552394358452463706047213m,
        69005334704184975885919183586m,76430650871869430160010500862m,72379644359124159436737149405m,6823026005812611592405777123m,
        78301978610601993597020269320m,78021649545636043125536713220m,3091176226578397143656759047m,4052395127586500874660086275m,
        5571957899690514366168634910m,1541422886934974804667266798m,12716880441326190998910016801m,16792202233987905135325024535m,
        11172982796850424065465526824m,10568642540748783157003226913m,9916880092848445764448756250m,70285804835588813014047524585m,
        313078380945841089783908074m,5864447391199148055100985124m,7455601994558697931136046362m,64982080874667561820399853258m,
        76405187761477574414023908331m,9283350852676731403692476720m,74273961391063614267593584112m,74566478291756248899383785969m,
        925881007831595143256546055m,333829196278612512026526210m,77371328474584782083009805050m,3392156125019866093661195027m,
        5289074515803448316318913798m,77996333586356049972010876938m,4645939593246847354394051351m,3417586126253335016699930405m,
        2798781922664034853623368962m,9001699821114096946909614360m,6527085096303716342587460124m,6836589310342805610583229981m,
        321673789580462166575882521m,2512299338834853686733313302m,3433429885506686591674552845m,4338934250539311532042224904m,
        6517418559400405161130329866m,7107265636846125759310798626m,11528530232322492290571057466m,16161209145367854447762417720m,
        14602851999080674714263170595m,19246227331612310897589827904m,10874501382001085527662530861m,34360189209219908779383059788m,
        69903827405302601987744587741m,77355460694858113270333629408m,69288242086136273177514341856m,71490965767582625940900083423m,
        8065820196499749378717335058m,930872920746811495401522691m,68648611454084814556210586825m,78287471667652576442350304259m,
        2481934375420342201352907013m,1842327354407819878114394626m,76441602574263342316236506111m,1232995243183501575244866049m,
        71789552164215039096235488238m,78911334077421068507289945078m,932077047521897986620460798m,4023371241105758508967588338m,
        74557925974140425099922244344m,2492752891596953656681886190m,69013830187302639171882837757m,4616849610927228011599165188m,
        3410521663706885646162327288m,68994411481041632737909138399m,65256455460139415164727977709m,2798715089959643497899877875m,
        610417388944828002851750139m,79225820294856227360786343637m,68376839245054483296582101490m,6176396810649400806242507232m,
        75793594316646227162572913379m,2809472733546601700177089781m,76459689238767012992204209678m,3091246765487148272603037936m,
        77357977752726126766188335085m,73353930251314529491439972606m,78304496206315521770717641233m,69927957831042422882208517917m,
        11498221564545303349713244454m,78918682261826057468733295379m,77388215489454841844452030449m,70238486152244021250754282243m,
        4007541595113305666341161197m,66768816607589141122109342463m,76444067594885265336819184129m,76419832593694832857329175057m,
        4035436887896506717964603661m,78919900652484415408640686085m,72424308759498150913689450993m,73978944900700451001070319088m,
        71522384579263401637171620365m,6783386313348955199547502351m,6489570484018075464045765622m,72756641302103356951116055279m,
        75569910721752293141391008531m,73335739658657230516810740200m,77668581817273934700295023862m,74568915180654044046529202173m,
        2480763005221303951360261625m,74895343913003377372160253443m,79213731109143535712976173808m,75519121302519125528605624837m,
        934528197120560061118545165m,77364074660908543429005933571m,595976615045680103554810367m,74902564416125333640376684580m,
        6203088531560084094913286149m,6530679075452172249243195897m,4647134128578638937892918792m,2456499393488828143767381237m,
        69591668025518214332357401567m,309494473142932666834614272m,78916226743811482521634797827m,77673460021850448777025549054m,
        74883245228378311600526656504m,1221100006908720106214195467m,77977028221648412844381499659m,75514337710863445809467100908m,
        9019899728084324218518771726m,3093660485557861987977721828m,77990273996878153221876218108m,67783237835951642804993335792m,
        3129960951453467377910939401m,5573247236176144554876802568m,6823295329733005676517988359m,4376396748321005746019042069m,
        76440417853106376388805064213m,5881518892375791907648836856m,8391205895257875726618333200m,7211126900236182149008106m,
        4357053343477534265645072395m,72409787741464279696927429352m,20818160337169829256304539688m,13370970942264520341451856636m,
        24866773402310876946702349381m,15209789595309950425044504841m,18969704124893182962893139492m,5614356210581933375598824723m,
        75825065089228681580065912830m,75172126182997321084943597038m,68986161876524989715633201368m,70232446024508990767854259970m,
        1866676060389162641711885562m,310693899828605777261291010m,70517748237863043007769214461m,6809855346600960009969070088m,
        70226458689264967023980836831m,4007460795061859731583861004m,77034089655124215918482754297m,1573964490845746392449085730m,
        73327282691835711614866878959m,8345143747675710423634215687m,69942441422570823850871352292m,5907902457613020672558036000m,
        2104711938777039299146352866m,74891669857688190565609566982m,69011402834285567842609454325m,1199211337964142388851826172m,
        77638359095913741728228441070m,6841339530039252549124227856m,600770571392227957281852157m,4043847347947997735109062157m,
        76117535340045726803375553014m,7115723171410276934448121615m,15242410928493527803283515433m,16761903494239642174205930817m,
        6225000845990487287853817862m,12417019118141364911188815163m,2835125718812752595994747672m,19845962919223240052163023156m,
        8697156971599939541502586392m,68709403549327391742830588119m,10878098329557326910720445725m,59396953048210634741569686715m,
        1559417978406139640902576170m,620193182235544652669321728m,71446032027716703694708804095m,73954828125276272543536965105m,
        5898301685300462254137410301m,73311693535918241591542807535m,77955168403338415956551530743m,77962337103087557283779247871m,
        75488983066095535487548322549m,72085748195011781143767869166m,72408611707779420327273824236m,599556184829692600918872821m,
        74253470691180177323508101882m,73636870782928183565210681834m,616490462924787295837156588m,72088109305113084565391536357m,
        78617602805000804242645837823m,68017532771853665920700701411m,73319962268405223684512081639m,68663179843642582445412962010m,
        74255613742537055394449579486m,70530974976625679814879337951m,58745194846312446990099721906m,56249735024928951323100630228m,
        59990350164169492131460793031m,60574148052936660579984004811m,65909274997626330339301578198m,65557515563289931520826925283m,
        66820748488657933892928654027m,71764098056695084813005288683m,8698301629615338645025267999m,15826227966861033590206445336m,
        9328346332915739463981020720m,79228157827283456132328128003m,2169955383097419680485406466m,77055670944245130902408724471m,
        1872616779412183324208065033m,3754064493886264590628689159m,3394663775120744171684167686m,626214203399623090881560563m,
        2164010405113412810076326410m,1867889765507247575932603142m,9601341008394700404430012955m,3113078432912503395557771280m,
        3710174562409258474346842650m,628721910284139377387836679m,956383402734351193041735194m,6535528762949278979257799965m,
        78605702905376423538221978358m,4341299823814514767725137691m,75501143805998352985651152640m,2164029164153425748115721482m,
        13977615197641904415956150554m,25439705513108259855375219783m,5285670337152639845469795620m,17698924953290082250561241400m,
        14274170867179522535577894203m,24239313473499308973585876816m,23266166151814997275055708761m,26426322237873799837638874187m,
        5280687372509099059708437523m,5307212886813353040038402829m,13322367699118738307564309030m,4030568348973331600310076171m,
        77980385877688649256234509297m,78919895910670011668816396034m,8666793925349441092311910665m,3412878182739108808974081551m,
        2525630615738962833029326581m,13018780111572350146550833689m,75515546600435812324328929283m,76730422489835153724727230462m,
        2784151108090600068010206961m,73948684049060282407770322151m,74885606206906674762871658244m,77038787837852986525189471507m,
        74588257791790423272748022519m,75503353024603752284399337964m,77051996813628064055744721659m,77959928384102093764669858552m,
        944336307597324691225837555m,76121109081597062736273732064m,74884539100518469218472357369m,76118715027202889317839142657m,
        4647181907744774125738722316m,3097268059813154516969587462m,71487377360701093668659720171m,1859365505539208066934639106m,
        3096054172606682832895086079m,945432251433842978165946125m,3994323983305690713263372343m,2195499125217551646689782244m,
        574097688567617735733739269m,303430899893122913049116666m,6843828549874379979807132429m,7135127320528557492012524062m,
        76167318656858842563007345638m,1236726446437510492870345727m,77013258632189923691509047016m,73324873253351517717510027497m,
        75795950981007034058664963311m,78876218301710976740013630180m,1240357890201759794082088175m,4330423937320319881858914817m,
        76459774332942152479899586049m,926098661330587821431985676m,7747977058164942306103462662m,324006100698088074377105413m,
        74588224918825291460735923188m,70870815950594827163809352196m,76451221906312777677062998235m,2452934099252057010493126645m,
        74310256965398351496522954503m,73948702883543753935376412914m,73310390215794053562529015777m,72701119438919380492894728425m,
        69591696358485337336059715805m,73332136327515352971097929959m,76723230270423978928822219487m,76412451037177761195600378874m,
        75183082279185513030021411061m,79219605566160847682860084198m,77974435236195064044548775905m,70857508358369993345143929848m,
        5275846742374248381773379584m,1228192871805594037424098306m,11162031168021916708604872215m,938235769371790103140826614m,
        4642232500676029123293483028m,311917028199187482077692418m,7147254320836546904090086156m,78919971674323757736961249534m,
        3706604434532724998541545748m,12691421645373729146492621818m,309484991442710255312691196m,73975318363770957761388933122m,
        77392984916170293894551044824m,13288502981151441354914865377m,1823130362736895217107991059m,75226471951971126046205078804m,
        1559424156334632613485215500m,302301996329650087453651706m,917574622504812749905853951m,2457750968768460060967896523m,
        597143057145611915128542960m,622577760135937269839691529m,7422837718922152542112773623m,4331609326242062134308243968m,
        3070709065243125755518773733m,74589457105700930654343525364m,76140547083746571707598574858m,5594984511465126661806433292m,
        4366758398123998780694395914m,11157242760325969171332273929m,3406823702218953078750516724m,77697662778701685181381474306m,
        7438548534654371564495373298m,6815895547251542357722401281m,4955476844967433154127790844m,74900123224655035930920612616m,
        6183730849362585608077180944m,617761094388839047560757763m,2133640052863291072523732214m,20976170756326462895041292964m,
        5512907973388069672019693028m,4905877275674971658866268100m,310698713207792664311432457m,77989041883645920553684036867m,
        78589882793918394997676183049m,3094902523354305376376329717m,4296465454843995317236730630m,2178607052347711401592552962m,
        640584549284144778603204866m,67801377000167293020502613786m,1210172153704350994456568313m,74271495537897536104683272169m,
        77368711952448308737906307583m,3681230956940117088608190445m,4008802279610827996240283392m,3705329340172314317805388534m,
        77351932995148522178181462773m,1832783395535102625146469341m,874066797465230212947056131m,4658128907741452295659590908m,
        5591381161659468190476602907m,2202767104771362628472865555m,76760754453833307537290304013m,77697818392700999562215239431m,
        77359121195127988795821847048m,4041424591067722818572845845m,1549904642791266806806674703m,78311787149682101695901596669m,
        7433656475200567509285530097m,311893985116744872355692290m,66571639615566864142127849725m,60072591374516251129114438478m,
        64731669385536140714301119997m,68383941871456827996714423552m,313111821357509971096238336m,75184211087260865944888335594m,
        70862291507166190653419481332m,68385165037802293721011840260m,73952278102714890879561233898m,78302054168673470029790573556m,
        76088567548524789625446851569m,900616529602003654638372065m,68698215932232227447200807410m,74270253429481009023413314820m,
        77966043330675912882309752308m,70534616474729844565246728433m,69291816659238997727645062612m,68981103686198710382105515768m,
        70852521281762690026772878060m,72091773619824860733141412348m,68382780164604155342908080353m,61214906922947135023439202260m,
        60901752746632636300501371840m,59036394558393447300490771647m,65876487141848312619526768841m,61820569578456089204420955340m,
        294977955541250803826369550m,1242893874578973848472254452m,924705268419518878602754812m,74889332709554216534985532904m,
        79202732405889955405845566960m,618975258304945911066854143m,2497844544253627778975143951m,6204306846988058605554568725m,
        9618403012326719171180173844m,75539810469267234892660542995m,4761713885205851997696m,5891105019200530363112101626m,
        3131165335348068257084471334m,78012031083619545388728058142m,3435824310424428095062610967m,9909649650757293344629660161m,
        75193882681171765020868941059m,77707319463464312732524541702m,2180939902754568182501540074m,1242785206107786016376357898m,
        77999870380094297698845269006m,6825713182453956485543628550m,6820816548929598791600904729m,3438223051095753841722786829m,
        2194224271171507549985379345m,9929040131416370524652244502m,7130306060624592048583807759m,14896564029663819989975902503m,
        9953280760021198215575975967m,11810200097729651289680190000m,15212060831217047244720975138m,9637798083258020847887852589m,
        77084812761998667838682301188m,6812335198035540657970024465m,6528379171282909363471581436m,3388482250637323203303576062m,
        71175408494839837306160865002m,78918710099549854833563401985m,1833912264072657225106785821m,78286456820172620227995108859m,
        12528173883476475156323305993m,3717522287229515140172747009m,616556891660790165160066818m,5880253371218596227844080661m,
        78013178175380207847757388310m,6100928487794917416965896m,73704584796939068896979713522m,2493942742841179209325738480m,
        76753382599869287441901360135m,4649448366451834851437639391m,73374406951994406325363475458m,1244107339232375931792184572m,
        69031958983662520000281050312m,1241396627519146489223121161m,4635050019192858359959065101m,72715707475338531274796236543m,
        75498606952896483964156571631m,6517267036547522729844932869m,75445447719951583528558460684m,349460140062073272606984710m,
        3409175957598511312823582205m,4043956387665824233897596421m,71803997993601281391427259378m,5586492863455833248830782233m,
        78635788751542062400806522112m,7424022901400608636865083643m,5314414293642345298760037916m,67754309577461417038843476967m,
        74572550960048565042777425392m,927170396766154246018170622m,67480921323107371623525709807m,78923503392755433495529911539m,
        66067460862000763672377685250m,75823732313480555400188584172m,310708084717845893384045055m,78598363922727556480460190196m,
        78910162835981091593145216009m,1218663209312921326084682218m,69623043354066672902451561725m,76152508890284656464253154308m,
        67789141348816782507896010257m,72750898127039218093271407911m,8897726607003888265134997220m,76730380245434542961798809812m,
        73024985255447718856446242348m,1836561326413985194477156845m,74929203391951772155091681792m,73953567162486959459733728002m,
        3710141079046982911222351879m,75808116073264497590253912298m,75838287089988341155104025317m,8074307139998456146967398416m,
        78314257577569540881955887118m,5588916434310279391256442878m,5909219907648207512188819717m,2461458469827653539442720003m,
        78592220142809616834759226629m,74581061292870605412285023235m,72081040457376818072034802942m,2816777754306034017272849136m,
        6799050978063197738531294461m,79174932277268472080768040960m,3767008667523298432597685752m,6192089844223377115691815447m,
        2810847330083385185475043353m,3431045218840614605432748538m,2422610970993999596290302m,78010726990458121648630267654m,
        633505519378624432872289277m,78300892963944082165684110853m,77990279106918145718433480965m,1859332778560779408006970872m,
        2157875605009735955930740453m,74879538244473988857108036858m,74581018864775732764760603128m,76410151428590451239312619254m,
        77982925680316684618073437938m,79225678402286314156732251888m,1248862891336074567858981639m,4961455324260280732458418691m,
        1557143955744230863614315003m,8359688841090751369509668628m,77374870175218552348394845947m,69303986384506508397784126936m,
        71465535714238221138874591470m,72068742974130789806652194042m,69316047381864571740337134567m,4598578607680776976685396749m,
        7497809513463719982863412487m,6479748426714657404734160426m,14594413186160607523212111412m,77705106091611468890415770144m,
        22029206535710495702272324391m,617803924497245532908945664m,75496194231119296673358608122m,72712052344376376392757213190m,
        74594312013259605378895838713m,68068648406049513085439436265m,309489786660255059327058943m,1531552896930895400216690427m,
        78607940808021733357974586106m,72710814901477369810330646003m,605629020369124879963063283m,69931555907739737044502439385m,
        73057758036842074772602092801m,79212493703283525667420239113m,5866930967066666167576562676m,1561889640634236513879064576m,
        73341822160504467462578959635m,60350828007701896147292904162m,71472803841502217395512274163m,63734464964065259821897671388m,
        68059954140752699653994967267m,69296780012980786869547887588m,69595280429638303449599107542m,62128817101551580902875449303m,
        65864478663744209497535472598m,59652974746205695709568553684m,61526918751418008402055646417m,65224937712412006298343752134m,
        648254687611274999934106139m,13374483494164049110804270362m,4023281478951288707220044286m,8327057383020332989926016008m,
        5280649353698630604957496603m,10635204625544978330728399102m,73988673417303186781980394492m,2803550811183818430656474881m,
        73641659445273396738670982124m,70552721031992863109982246882m,78918677505381714836358037505m,6516152798293377301956327954m,
        77046027742175843067780590064m,72090574288118109004779813351m,70217853819626749947737072607m,77971979399962581220949229269m,
        1519548807271052733592435969m,69293106087224835297721116376m,67146034536295227626329463522m,67717898781515192904600836068m,
        74225508912446412450377882824m,68038108714293478326370499314m,75497365359125415434145232895m,78913813262823086346195432690m,
        71470419008308201039368284404m,68657135049679271805208289243m,70203422599628370101227676391m,72690296105254916121455357414m,
        73015421557777725642723290599m,67734767225189867870435341810m,67437362102546039244683665871m,69916821381329295233767424211m,
        3115496453819524649113363998m,10551599870667544097072216863m,5264872164263487653742382370m,307062195496770448803877585m,
        75470645879253049808270848224m,78566894405681158285667991555m,7464069050596053247433318661m,2193109902568807289285907726m,
        4972458567876088687855147788m,6533167983952936851058596112m,313111843122858340183507200m,75493696616339128268352457728m,
        7471280086713279030310937890m,1254964502716512913706722321m,6531897206349615877865213970m,3115586396679776020757413621m,
        4340152401176077510788322570m,11163363059637161762918833451m,13049301561461528973445640225m,3149327726458879879213755411m,
        5325408496042643141368879389m,8055134219523478450654418446m,12125668234986745357342479367m,4666543833129143807170651928m,
        10853844788882129993691564817m,78600678180052651444830865682m,14896544882229705193749356327m,14284913991155339084182199845m,
        14926829584870434652274704945m,18910302085282320678843988027m,17098131561186037622403052855m,7807480061268324405263012126m,
        78264638951128297439898758616m,75823831923303088318388174313m,4945729601828013237030159091m,66489493515472924003554019059m,
        77355527326237563903361482505m,78636998268016354832618225412m,5895945408673110169249974538m,69602577242817142708766830582m,
        78919815096411651607411684590m,72975531914940063724802995433m,311907545204729955445834240m,76430684425774072420670109935m,
        75494919265082470230291701483m,70230027969593018116503500778m,72709558584962580170442074857m,74867429765200595096272893425m,
        70552920036336035585991569134m,73010595170678671378482065395m,73954756809509786398708981991m,73935366624651364816194957545m,
        71148873076229451105583363563m,75505832285382797483880871168m,77044823446132069703980480506m,75499721672709585255481471738m,
        75804404183465548755328167153m,77985287490598794692740510716m,76751078083070209566763382008m,72398921245305769387340390634m,
        73022698947042533635798925567m,3707742211406785669978781963m,77694012111051092504646124533m,77674678447020436942255876602m,
        5906867670860919299506309385m,74879656432115594162254120183m,317970991641081842607714808m,76422169999080054889986396663m,
        4659270761919624445015751944m,922420343160458134086091004m,75507079451805317408066556927m,67396240250994712213849635554m,
        76422193352582040660059541231m,62775640229223650969024719068m,310688548181187320361255426m,76140579713576737933714652158m,
        916370494284583395216065289m,1552308141710724784034283779m,2786630812313185038405338635m,2487974003074561787102887419m,
        75183143520213285329665000681m,644414001703346100724698364m,2480691968401357634982841611m,322849471409494849041273861m,
        2804759625889516975116849928m,77993915311243916263833407489m,7453108291859611580589807122m,2806025774304419523151072017m,
        5905706799174700753773990934m,4036717018435918859039479829m,6229680084552009277268040217m,13012915485734016601953865500m,
        3115468060527459580768355359m,77992683270138508228121594105m,4667596347491706765695584499m,627460946197802867920534793m,
        67441036840892386058516759021m,4967509195251721350562179850m,622568665962064922329550345m,4665334685302909894886820110m,
        76730493546480526272751996168m,3400708275163663157088618248m,74259477448746481401886604807m,77974501237195753630814435074m,
        65578119711162557383344845293m,303312527640505889330429188m,78921081280420482317300006658m,78907711983917510678163617275m,
        73951187069097940016002559209m,74236394227166190552923044850m,74255807691605398772471820261m,77041116020591249017898793464m,
        75191530923205471795399881205m,71776234998782790124287099122m,70552816032939077173671879907m,71137884127758287460870253547m,
        78289997837495509372787027441m,76420918498173406126177451516m,75810458164416310454363484135m,74570085977407750454075780850m,
        76436686387843302703378787566m,73948717014110848990849987054m,74264223058988199514465366511m,73318833642351350025764466939m,
        77374798804990383403452067825m,77042339277654424093238952432m,78902956615998105437309170665m,73646537540399785603491227373m,
        73358685416179027981118932986m,4346078563691936345828560655m,77055808150549972258318711022m,1237916225333382719978867982m,
        74266820932774137233002397687m,8064753495004322510971802393m,66179017233404418425950167259m,78279003799601009834617076475m,
        62462783819456866248885394130m,77678158241108452449643462137m,308304343909530778789282049m,77677157561381010788325654546m,
        4654406924832154074708315392m,2802337550886024631159617546m,77683126798419292511628627989m,78938096189373514988809222920m,
        77979304475431620555064870903m,78018075252265099906916481271m,4638766487175577793333366290m,2495312654338128429849118988m,
        4325541489053107514704989442m,77073889706457337955848683011m,6210346826353980770269010199m,8387626876923850691907490845m,
        3425000571942899591228626713m,4664125778941102996510150932m,4359476563914161328936393493m,8038204460815112296666108934m,
        76763210342076700123310519297m,2480762820182204020951811339m,322778564216057291288608779m,78938124301129216452392517882m,
        2790167994444658385603066877m,77680761242580078689307063533m,8087699456814709571880095770m,78923593838152419018910005248m,
        4365374208336758535255425034m,68688737903331144157440370911m,7426426625938538838975527151m,19888184998454461943431892259m,
        4338901231005625987284931355m,76445196756619836294996619775m,297357568089947508725383169m,10874401290032452008135628036m,
        7413270758052552702832092443m,3739288264427025553223191319m,76396844111415381261349612790m,72407327148788826285014179812m,
        6457887630163393684857746431m,314419588882029532454916625m,6537913759347554305625296651m,6194621289104132197556286983m,
        3724681487705971244500974607m,78587417995102439492623011566m,17363938626841781551378345531m,9018771450703017262686935072m,
        77047198833503506286261304552m,72407327370729874035420618733m,73327329055927193064838328055m,12446204246178776182490546468m,
        8428900893717827840951922491m,10884082305824199032522541600m,76763200656600175832379425780m,77673426705947521588900266226m,
        64700477143572102109095388632m,70867151395574091020157711605m,13293367352483495238950656816m,4351123305623735691038823168m,
        16726707309601366963657779997m,13339363807880675088374183217m,1547434512861741266341454074m,69289550293846013303020713445m,
        79217229826636608447430982392m,66177632396045155087243585965m,79076444705046739936587284738m,77078763667048704480439702034m,
        10840503882638576650082580218m,77047198722467275190535843061m,78619992508941111125683135726m,70221594469705682837873688569m,
        10540628481767911542231594735m,594772316402745811211192298m,78616299249630833427553190894m,69301629979554728823333250563m,
        299827529185958214064990958m,73949831400079698963096338398m,9290637149782688142902366996m,77979356438320999531555522048m,
        78281535357832610114447799530m,78600691994346530687662098691m,67165585801297123844443789266m,2197969530838346624139075611m,
        6547641557682739026349461018m,75203747870703945710816861203m,319307975485116027403698154m,78302101889970537918172896272m,
        17035030248203602695853657906m,26075581678399941371348927302m,16782535917573808072834951220m,74903849446350519767274291711m,
        68977528653226108353928806626m,65551371749448665277297967305m,78611619790488293492128476916m,72107518507777093429845029364m,
        77372432861913641646198486525m,75513076783239343603714094073m,77988966546783947142509494782m,73938979751447539911112193262m,
        73009362577758740504395703527m,69920528755996319789854943975m,74871089580275065921079206897m,72720429509571697285729872880m,
        75811662349705565055412530166m,69898664270877088399794825688m,70232407967864615985112871146m,67126682499879722214893674729m,
        73310337882168300428071722987m,73327314768622962620254973157m,61838688888410293190020548551m,59656592060413041583506049733m,
        60288860357317962192665493446m,63704099391259087228712372181m,67419185325922772728057747943m,47556325822479280761878325168m,
        50043109421847998506937132187m,52813925267825952427277264800m,52193746082845043906933205928m,52190133823840465186342874276m,
        57163682840240834396628260893m,4659304666097633446215813909m,4045132146024279264929323535m,3416453180913542185627292964m,
        7139972855994249976471620881m,1869004113422074730572157461m,78918691653312707682802926083m,76126054286268338608506338555m,
        3106962913985465480172996873m,621397464599338427504657923m,3719874357852554506998382080m,6512559447059604092507326478m,
        2510991151084263534387793947m,7762626376333921051018335507m,5294023631254818898166156574m,8701957072441324423860005403m,
        2515921451504054800166363935m,5593790102148299099823803412m,6512611172380476574745103905m,7761431322465559550442476561m,
        7143642411311038661535799572m,6522245225797248043674309402m,9631692158374656998378385453m,14283662545668023658618497321m,
        10567410169117189202523270186m,14907468140540569332195470123m,12438846446184358252223604508m,31370824123586189495717222237m,
        24264809954275291114173000541m,30145044141388946390791840870m,26726206626353144197342909019m,28880436232464244529692696925m,
        27652177483572452662075526422m,3414035218521235569210296334m,6513782263928556793940547873m,6523501243914490660759604749m,
        2801104957241561657861475334m,77993787621722020596678134270m,622606259700824826495628033m,76742568250991345676833190631m,
        75183044610070859297410841837m,76991517227055023010466372118m,359268916562940934890913541m,70226467802893260489805585643m,
        73624672764315662973838743275m,1833812743602396600929422335m,8394908656379207594969399072m,3382414398464057196685500711m,
        2213807865949782255175079183m,78321501023523683243536543484m,3382546016635752538654964207m,6181261695012048566150503439m,
        4707647310709214903028278551m,76758218909139691863832526083m,1837495856911551606923379451m,69587961537435657433031110369m,
        917479752633061179945771531m,76727995656439216145278962689m,13034837136954544464466549033m,2789072977056928299449386749m,
        10870736789271329271531569226m,7407075198118919750963631648m,25147197525163175344044045128m,19517069971246531690027177030m,
        31662065961009699271729287267m,70527533108896257493001822442m,76721963992946032004350861313m,69895075973391948446416494302m,
        1820641675011331864705744905m,59307204036118365632374571479m,308285523602805778069123071m,78604313202050337798534525681m,
        75490116415530640180184486379m,5271001374215619665558569721m,62170129640632064830221713378m,78284062320612542809136170768m,
        76741321581904144097286693127m,6842708517391981178672704239m,75169699237765476348707221229m,7466547833281998770129273607m,
        75209731365777867064091607053m,1211348595102389034480431596m,4014781367065230436473118214m,947925218142307571241768960m,
        76408980409826748944507473906m,8066189298701498971363807242m,68968080008406456321152852442m,7783267306359227280412702986m,
        77665007447011640932393557766m,12427979306187013081290245909m,940648753018966885304250634m,12128175738384577535135710237m,
        5593799565755558472377517099m,18942980419345072825554374686m,6513763743393571693641419031m,20814411849103240089707356466m,
        18637070510059539858396853310m,58407668867895564910350357956m,72076000624739064502390674152m,69910830287912401239452226562m,
        5614360178377932652416713005m,58099379376516776631964344057m,79226963014732389353819603202m,3104554691044492430662102530m,
        298609583264874175664555771m,5268546037709873388268292104m,78924646833932321941641696015m,76466990128524815997346059272m,
        947835953262040847331949311m,74874820601660572915737425178m,2165176863497217536529856513m,2481943579264203684910596347m,
        78280345818465502185029823484m,75513109691144555824808851711m,73955876600734658554229814526m,74578553457070286987944850933m,
        74878381284068045041005356287m,15734850899063293996364789m,1231890392530759922566693623m,78299622315175794447642393340m,
        78927055075251071106835545864m,73323730902484574076186390016m,1248801205426694699215876839m,78276657280150351464802028020m,
        72450872831247920025511587091m,320435865249436122224459806m,6506500244314784973065099015m,11138962534862132494235208706m,
        76775205081683886557848004878m,1858213617549108024875613474m,9901253965687870838947194642m,76445229922497145090173765102m,
        75531144724359146468783427074m,75206170499689058930787744532m,928450362576508929912930307m,68704439659254474896485441574m,
        2474548757595654778256754685m,73003356187894221159512732921m,74884397412591595376749835512m,76451259886723603247440916732m,
        74900155967343723302849870581m,3401954702638079653639029246m,77380858044343232209681905918m,74903820763465274730852841961m,
        1223291014908140664919945977m,5228557534744462541221276633m,68758681226886572568448325397m,64090082482028459483065865758m,
        11099298325227090064925792732m,279229396469384874895024586m,78592215733895065556790933235m,4944492287259379264713585657m,
        77982940566762037867159548160m,76723249325615071539131315710m,77350662954688485222538280683m,1865349001045715867929214231m,
        1848462058024105560130324727m,2480692152366079524025992694m,76765552470623593864077248252m,77382246068729062338555278602m,
        1240447837466602078068143866m,5284290188511201562364417282m,5915397132017586708238307860m,8973903915714976004317055239m,
        79216011569290467649846045957m,1265726406928249182158777614m,308285544875561826516074754m,73310328310045705366388272873m,
        76431827386979257750907848450m,74300656651088928582607695342m,2786464754290969441457279493m,75822613811866506609487311336m,
        69887845146160012477681438696m,68405839519860424063796040924m,72993542871546458238243371498m,73367290085651091393442930151m,
        297324710548741455124566277m,70531154151587281466529541125m,72702239192674014589919754456m,73044483186162006344316742639m,
        73646419335251291093600174324m,75207270291766115623465710322m,72384281760256232138669355235m,64377736264703729941228611559m,
        73295826014082335208955444979m,75514318764690425238349016301m,79223246235751024808119567110m,67785726963576157701489678335m,
        72373467393436473946781645817m,72436388886924425966381422303m,74242424486976565204499827197m,71823548445293321490959428852m,
        617737662561054322727325708m,70158535861129625492011080665m,63404475514135623869340304085m,12324894103193995690951509786m,
        6534329261830348419787911679m,1177422672981366390593362438m,2413165871796235347820800m,73956013291256603963295069424m,
        76119952657164824054825483774m,3702902007620972895217389595m,9027223896481054638351571689m,77059359001861535174812369652m,
        933347272739293930445993983m,11433987440972465149835224619m,12426752376056692797563932439m,18879875470525487109028720929m,
        1595980551132506846489151988m,4380066062898993561399196939m,4966300639377492214453378074m,8688677851248947110691022115m,
        9642652918122710879318639876m,7410621124650595103647274520m,3121551059505698157805765895m,12380637747699555343082528555m,
        6222474140835626734287257868m,15167183724597006239331074100m,17098122337234141425166722084m,19242708876619877302528719427m,
        21433349494417337189726305854m,33793359557934108684434428500m,28585506221603750178182607670m,39058283411643968613077250667m,
        28585520528247094224358232393m,2809567089649894664564571650m,70232493616460470651819712992m,10495685740835827023876388355m,
        77988923840552361372841396421m,72654891677266051820867546341m,79226948884665155416873958913m,1225808040054969279117524224m,
        77036351501062707736821824478m,79225612177389417344365100282m,73035954667448338734167946000m,622592111048968022904859150m,
        70878036153577153650950074350m,1222218949364649884717817582m,79212399124807654009862482681m,74284723202824052334684993021m,
        935736772808147038538762756m,4029340237827761897801381669m,10172067201849037579776823792m,75236256826613988750577966833m,
        634672425099108693599122456m,1537791458164030217152820493m,2162716216128098698800925708m,1260923889912935648334841339m,
        78599501884788247375865246980m,4331585860117978895469508599m,2474689489104943665478960642m,933323956625637978788535057m,
        78010751194462687090408357913m,4959122216316478031964993050m,8975102989679585293335861244m,78329897963473551839852888828m,
        74579809866036680755405647359m,5266108852871773645887635463m,73624871544626115226972061166m,74902479371216989124411262459m,
        77996300384523391504238114333m,6211654716864176445472900098m,930872918705270246971997697m,78905289170970780439912062465m,
        3686194457174136113004739051m,74304051978182930701359913728m,76765689344890966002401264936m,618965278398798761604614135m,
        77980607977271253101448001024m,77371190861804453510722552092m,78616465216068123255097920527m,77692784758528442299096303120m,
        2795083938614393051896743438m,74304061480115611534003083497m,62541213496369148143674055443m,9863733582089965292501327129m,
        8312667975951545727097312490m,76165821778291459752614825717m,73918688445236169025235972330m,72720443899331363370594794498m,
        77372508532040593314746334708m,320322952234421412097955851m,3410469590431768534506209035m,78632058432510133580942549007m,
        3390003224036439825332111599m,328813804565435842053277709m,3734443080678968690182651661m,5261363411171102284075960348m,
        6184906756882247184135096859m,631210615287517288865795374m,70707233579962174606856m,78607979013104200947686301926m,
        77681842018497592829829050897m,78582577105686340961286607583m,2683791817603844954737154053m,2160374273354138822542555400m,
        21798130090277029244043264m,
    };
    // readonly decimal[] weights = {
    //     4349781471371375397292609038m,4349781471371375397292609038m,4349781471371375397292609038m,4349781471371375397292609038m,    
    //     4349781471371375397292609038m,4349781473469240409596832555m,13360043090640653005970156331m,13360043090640653005970156331m,  
    //     13360043090640653005970156331m,13360043090640653005970156331m,13360043090640653005970156331m,13360043090640653005970156331m,
    //     13360043090640653005970156331m,13360043090640653005970156331m,13360043090640653005970156331m,13360043090640653005970156331m,
    //     22059606033383403800555374407m,22059606033383403800555374407m,22059606033383403800555374407m,22059606033383403800555374407m,
    //     22059606033383403800555374407m,22059606037434453479487668095m,39458731918868905389725810559m,39458731918868905389725810559m,
    //     39458731918868905389725810559m,39458731918868905389725810559m,39458731909681703441429135231m,0m,
    //     0m,0m,0m,0m,
    //     75189079719419489010343670514m,75189079719419489010343670514m,75189079719419489010343670514m,75189079719419489010343670514m,
    //     75189079719419489010343670514m,75189079717321623998039446997m,66178818100150211401666123221m,66178818100150211401666123221m,
    //     66178818100150211401666123221m,66178818100150211401666123221m,66178818100150211401666123221m,66178818100150211401666123221m,
    //     66178818100150211401666123221m,66178818100150211401666123221m,66178818100150211401666123221m,66178818100150211401666123221m,
    //     57479255157407460607080905145m,57479255157407460607080905145m,57479255157407460607080905145m,57479255157407460607080905145m,
    //     57479255157407460607080905145m,57479255153284070755310534784m,39769430595395432203818139776m,39769430595395432203818139776m,
    //     39769430595395432203818139776m,39769430595395432203818139776m,39769430586135890082700230784m,0m,
    //     0m,0m,0m,0m,
    // };
    readonly double scaling_factor = 64.204;
    readonly double shift = -0.006349999999999967;

    #if DEBUG_LEVEL_1
        public MyBot()
        {
            Console.WriteLine("MyBot loaded!");

            // test FENs
            string[] testFENs = {
                "r1b1r1k1/5q1p/p1p2p1b/3pn2N/6p1/4B1N1/PPP2PPP/R2QR1K1 b - - 11 24",
                "rn1q2k1/ppp2pb1/3p2pB/8/2P1r1b1/5N2/PP1Q1PPP/2KR1B1R w - - 1 13",
                "r4rk1/1pp2pp1/p2b1q1p/2p1P3/6b1/2NP1N2/PPP2PPP/R2QR1K1 b - - 0 13",
                "2rn1r2/pP1q2bk/3pbppn/1p2p2p/2P1N2P/3PP1P1/4NPB1/1RBQK2R b K - 0 18",
                "6k1/5pp1/8/1p1q3P/3q2K1/8/5P2/8 w - - 3 44",
                "rnbqkbnr/ppp2ppp/8/3pp3/6B1/4P3/PPPP1PPP/RNBQK1NR b KQkq - 1 3",
                "3N1k2/7R/6p1/7p/3PpP2/4P1P1/3K4/6n1 b - - 4 45",
                "3qr1k1/p4ppp/b1p1p3/3Pn3/Prp1P3/4N1P1/2Q2PBP/3RR1K1 w - - 1 24",
                "1k1r1b1r/p1p2ppp/1pqp4/4pPP1/4P3/2PPQN2/PP1N2P1/R3K2R b KQ - 1 16",
                "2kr1b1r/ppp2ppp/2n5/4P3/8/2N3P1/PPPP3P/R1B1K2R b KQ - 2 12",
                "r2q1rk1/1b2bppp/p3pn2/np4B1/3P3Q/2N2N2/PPB2PPP/R4RK1 b - - 3 14",
            };

            ChessChallenge.Chess.Board testBoard = new ();
            foreach(string testFEN in testFENs)
            {
                testBoard.LoadPosition(testFEN);
                myBoard = new Board(testBoard);
                Console.WriteLine(
                    ("Eval of Test FEN (" + testFEN + "):").PadRight(90) +
                    Evaluate().ToString().PadRight(10)
                );
            }
        }
    #endif

    public Board myBoard;

    private class Node {
        public Move move;
        public double prior;
        public double value_sum;
        public int visits;
        public Node[]? children;

        public Node(Move move, double prior, double value_sum, int visits, Node[]? children) {
            this.move = move;
            this.prior = prior;
            this.value_sum = value_sum;
            this.visits = visits;
            this.children = children;
        }

        #if DEBUG_LEVEL_1
            public void Print(Board board, int parent_visits, int depth)
            {
                if (visits == 0)
                {
                    return;
                }
                Console.WriteLine(
                    "Depth: " + depth.ToString().PadRight(2) +
                    move.ToString() +
                    " Prior: " + Math.Round(prior, 3).ToString().PadRight(8) +
                    "Value sum: " + Math.Round(value_sum, 4).ToString().PadRight(9) +
                    "Visits: " + visits.ToString().PadRight(3) + 
                    " => UCB: " + Math.Round(
                            (visits > 0 ? value_sum / visits : 0) +
                            prior * Math.Sqrt(parent_visits) / (visits + 1),
                        3
                    )

                );
                if (children != null)
                {
                    foreach (Node child in children)
                    {
                        board.MakeMove(child.move);
                        // Console.WriteLine("Board position:\n" +board.CreateDiagram()+ "\n");
                        child.Print(board, visits, depth + 1);
                        board.UndoMove(child.move);
                    }
                }
            }
        #endif
    }


    public Move Think(Board board, Timer timer) {

        myBoard = board;

        Node[] expand()
        {
            var e_ms = myBoard.GetLegalMoves().Select(m => (Evaluate_Move(m), m)).ToArray();
            double min = e_ms.Min(e_m => e_m.Item1) - 0.01;
            double sum = e_ms.Select(e_m => e_m.Item1 - min).Sum();
            return e_ms
                .Select(e_m => new Node(e_m.m, (e_m.Item1 - min) / sum, 0.0, 0, null))
                .ToArray();
        }

        Node root = new(new Move(), 1.0, 0.0, 0, expand());

        #if DEBUG_LEVEL_1
            root.Print(myBoard, 0, 0);
        #endif

        #if DEBUG_LEVEL_0
            int rollouts = 0;
        #endif

        // think for three seconds
        while(timer.MillisecondsElapsedThisTurn < timer.MillisecondsRemaining * 0.05)
        // for(int rollouts = 1; rollouts <= 50; rollouts++)
        {
            Node node = root;
            List<Node> path = new() { node };

            // selection
            while (node.children != null)
            {
                node = node.children.MaxBy(c =>
                    (c.visits > 0 ? c.value_sum / c.visits : 0) +
                    c.prior * Math.Sqrt(node.visits) / (c.visits + 1)
                );
                myBoard.MakeMove(node.move);
                path.Add(node);
            }

            // expansion
            if (board.GetLegalMoves().Length > 0)
            {
                node.children = expand();
            }

            // backpropagation
            double value = board.IsDraw()
                ? 0.0
                : board.IsInCheckmate()
                    ? -300.0
                    : Evaluate();

            for (int i = path.Count - 1; i >= 0; --i)
            {
                path[i].value_sum += value;
                path[i].visits++;
                board.UndoMove(path[i].move);
                value *= -1;
            }

            #if DEBUG_LEVEL_1
                Console.WriteLine("\nRollout: " + rollouts);
                root.Print(myBoard, 0, 0);
            #endif
            #if DEBUG_LEVEL_0
                rollouts++;
            #endif
        }

        #if DEBUG_LEVEL_0
            Console.WriteLine("\nRollouts: " + rollouts);
        #endif

        return root.children.MaxBy(c => c.visits).move;
    }

    private unsafe double Evaluate_Move(Move move)
    {
        // make move
        myBoard.MakeMove(move);

        // evaluate
        double eval = Evaluate();

        // undo move
        myBoard.UndoMove(move);

        return eval;
    }

    private unsafe double Evaluate()
    {

        // load board state
        ulong[] boardState = myBoard.GetAllPieceLists().Select(pieceList =>
            myBoard.GetPieceBitboard(
                pieceList.TypeOfPieceInList,
                pieceList.IsWhitePieceList ^ myBoard.IsWhiteToMove // invert board if bot plays black (white to move)
            )
        ).ToArray();

        // create network
        int[] layers = {768, 25, 1}; // optimize later
        double[] neurons = new double[26]; // optimize later

        #if DEBUG_LEVEL_1
            int networkConnections = 0;
            for(int i = 1; i < layers.Length; i++)
            {
                networkConnections += layers[i-1] * layers[i];
            }
            Debug.Assert(weights.Length * 12 >= networkConnections, "Number of weights (" + weights.Length * 12 + ") needs to be larger than the number of network connections (" + networkConnections +")!");
        #endif

        #if DEBUG_LEVEL_2
            Console.WriteLine("\nBoard state:\n");
            Console.WriteLine("FEN: " + myBoard.GetFenString() + "\n");
            Console.WriteLine("Binary: ");
            for (int s = 0; s < 768; s++)
            {
                Console.Write(boardState[s / 64] >> (s % 64) & 1);
                if ((s + 1) % 8 == 0) Console.Write(" ");
                if ((s + 1) % 64 == 0) Console.WriteLine();
            }
        #endif

        // compute feed forward
        #if DEBUG_LEVEL_3
            Console.WriteLine("\nNeurons:\n");
        #endif

        fixed (double * neuron_po = neurons)
        {
            fixed(decimal * weight_po = weights)
            {
                double * input_p = neuron_po;
                double * output_p = neuron_po;
                sbyte * weight_p = (sbyte *) weight_po;

                // loop through layers
                for (int l = 1; l < layers.Length; l++)
                {
                    // loop through neurons
                    for(int n = 0; n < layers[l]; n++)
                    {
                        // loop through inputs
                        for(int i = 0; i <= layers[l - 1]; i++)
                        {
                            // skip 4 bytes at the beginning of each group of 16 weights (one decimal)
                            if ((weight_p - (sbyte*) weight_po) % 16 == 0) weight_p += 4;

                            // compute weighted sum
                            *output_p +=
                                (i == layers[l - 1]
                                    ? 1
                                    : l == 1
                                        ? (boardState[i / 64] >> (i % 64) & 1) // for the first layer, use the board state as input
                                        : *input_p++
                                ) *
                                (((double) *weight_p++) / scaling_factor + shift); // decode sbyte [-128, 127] to double [-2.0, 2.0]

                            #if DEBUG_LEVEL_3
                                input_p--; weight_p--; // undo increment temporarily
                                double input =
                                    i == layers[l - 1]
                                        ? 1
                                        : l == 1
                                            ? (boardState[i / 64] >> (i % 64) & 1)
                                            : *input_p;
                                Console.WriteLine(
                                    Math.Round(input, 2).ToString().PadRight(8) + "("+ (l == 1 ? i : input_p - neuron_po) +") * " +
                                    Math.Round(((double) *weight_p) / scaling_factor + shift, 2).ToString().PadRight(8) + "(" + (weight_p - (sbyte*) weight_po) + ") -> " +
                                    Math.Round(*output_p, 2).ToString().PadRight(8) + "(" + (output_p - neuron_po) + ")"
                                );
                                input_p++; weight_p++; // redo increment
                            #endif
                        }

                        // apply ReLU activation function except for the last layer
                        *output_p *= Convert.ToDouble(*output_p > 0 || l == layers.Length - 1);

                        // increment/reset pointers
                        output_p++;
                        input_p -= l > 1 ? layers[l - 1] : 0;
                    }
                }
            }
        }

        // return value of output neuron
        return Math.Tanh(neurons[^1]);
    }
}
